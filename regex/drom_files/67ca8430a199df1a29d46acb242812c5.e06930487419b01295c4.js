(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6788],{74762:function(e,t){"use strict";var n=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}},r={elementSetShowStyle:function(e){e.style.width="",e.style.height="",e.style.margin="",e.style.padding="",e.style.flex="",e.style.display="block"},elementSetHideStyle:function(e){e.style.width="0px",e.style.height="0px",e.style.margin="0px",e.style.padding="0px",e.style.flex="none",e.style.display="block"},addEvent:function(e,t,n){window.addEventListener?e.addEventListener(t.substr(2),n,!1):e.attachEvent(t,n)},removeEvent:function(e,t,n){window.removeEventListener?e.removeEventListener(t.substr(2),n,!1):e.attachEvent(t,n)},getLocalStoredData:function(e){return o()?localStorage.getItem(e):(t=e,(n=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(n[1]):void 0);var t,n},setLocalStoredData:function(e,t){if(o())localStorage.setItem(e,t);else{var r=new Date;r.setFullYear(r.getFullYear()+1),function(e,t,o){(o=n({path:"/"},o=o||{})).expires instanceof Date&&(o.expires=o.expires.toUTCString());var r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var i in o){r+="; "+i;var a=o[i];!0!==a&&(r+="="+a)}document.cookie=r}(e,t,{expires:r})}},merge:n,setLocalCookie:function(e,t){for(var n in t)t.hasOwnProperty(n)&&this.setLocalStoredData(e+n,JSON.stringify(t[n]))},getLocalCookie:function(e){var t={},n=null,r=function(e){try{e=JSON.parse(e)}catch(e){}return e.ttl&&e.value?e.ttl>Math.floor(Date.now()/1e3)?e.value:null:e};if(o())for(var i in localStorage)localStorage.hasOwnProperty(i)&&i.match(new RegExp("^"+e+".*"))&&null!==(n=r(localStorage.getItem(i)))&&(t[i.replace(new RegExp("^"+e),"")]=n);else{var a=document.cookie.match(new RegExp("(?:^|; )("+e+"[^=]*=[^;]*)","g"));for(i in a)if(a.hasOwnProperty(i)){var s=a[i].replace(/^; /,"").replace(new RegExp("^"+e),"").split("=");null!==(n=r(decodeURIComponent(s[1])))&&(t[s[0]]=n)}}return t}},i=function(){var e=this;this.elements=[],this.add=function(n,o){e.elements.push({element:n,callback:o}),t.observe(n)},this.remove=function(n){e.elements.forEach((function(t){t.element===n&&(e.elements=e.elements.filter((function(e){return e.element!==t.element})))})),t.unobserve(n)},this.clear=function(){e.elements=[],t.disconnect()};var t=new function(){var t=this,n=[],o=function(e){this.target=e};o.prototype={get isIntersecting(){return i(this.target)}};var i=function(e){"none"==e.style.display&&(e.style.display="block");var t="number"==typeof window.pageXOffset||"number"==typeof window.pageYOffset?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[null,null],n="number"==typeof window.innerWidth||"number"==typeof window.innerHeight?[window.innerWidth,window.innerHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?[document.body.clientWidth,document.body.clientHeight]:[null,null],o=function(e){for(var t=0,n=0,o=e;o;)t+=parseInt(o.offsetLeft),n+=parseInt(o.offsetTop),o=o.offsetParent;return[t,n]}(e),r=t[0],i=r+n[0],a=t[1],s=a+n[1],c=o[0]+.5*e.offsetWidth,l=o[1]+.5*e.offsetHeight;return s>=l&&a<=l&&i>=c&&r<=c},a=function(){n.length&&function(t,n){t.forEach((function(t){if(t.isIntersecting){for(var o=t.target,r=null,i=0;i<e.elements.length;i++)e.elements[i].element===o&&(r=e.elements[i].callback);if(!r||"function"!=typeof r)return;n.unobserve(o),e.remove(o),r()}}))}(n,t)},s=!1;this.observe=function(e){n.push(new o(e)),s||(r.addEvent(window,"onscroll",a),r.addEvent(window,"onresize",a),r.addEvent(window,"onorientationchange",a)),a()},this.unobserve=function(e){n.forEach((function(t){t.target===e&&(n=n.filter((function(e){return e.target!==t.target})))}))},this.disconnect=function(){n=[],s&&(r.removeEvent(window,"onscroll",a),r.removeEvent(window,"onresize",a),r.removeEvent(window,"onorientationchange",a)),s=!1}}},a=function(){var e=!1,t=[],n=function(){t.length&&t.forEach((function(e){var t=e.element.firstChild;if(t&&t.offsetWidth&&t.dataset.width&&t.dataset.height)if(t.offsetWidth<t.dataset.width){var n=t.offsetWidth/t.dataset.width,o=Math.ceil(t.dataset.height*n);t.style.height=o+"px"}else t.style.height=t.dataset.height+"px"}))};this.add=function(o){t.push({element:o}),e||(r.addEvent(window,"onresize",n),e=!0),n()},this.remove=function(e){t.forEach((function(n){n.element===e&&(t=t.filter((function(e){return e.element!==n.element})))}))},this.clear=function(){t=[],e&&r.removeEvent(window,"onresize",n),e=!1}};function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=function(e){var t="";for(var n in e)if(e.hasOwnProperty(n))if(Array.isArray(e[n]))for(var o in e[n])e[n].hasOwnProperty(o)&&(t+=n+"[]="+e[n][o]+"&");else"object"==s(e[n])?t+=n+"="+JSON.stringify(e[n])+"&":t+=n+"="+e[n]+"&";return t},l=c,d=function(e,t,n,o,r,i){try{var a=new("onload"in new XMLHttpRequest?XMLHttpRequest:XDomainRequest);a.onreadystatechange=function(){4==this.readyState&&(200==this.status?"function"==typeof o&&o(this):(console.error("Error ajax request for url "+e,this),"function"==typeof r&&r(this)),"function"==typeof i&&i(this))},"get"===n&&(e=e+"?"+c(t),t=""),a.open(n,e,!0),a.withCredentials=!0,"get"!==n&&("string"==typeof t||t instanceof String?a.setRequestHeader("Content-Type","text/plain"):(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t=c(t))),a.send(t)}catch(t){console.error("Error ajax request for url "+e,t),"function"==typeof r&&r(),"function"==typeof r&&i()}};t.Z=function(e){var t=this;this.TYPE_HTML5=0,this.TYPE_JSON=1,this.places={},this.options=r.merge({banners_url:"https://bs-dante.ru/api/v1/banners",show_url:"https://bs-dante.ru/api/v2/statistic/set_show",click_url:"https://bs-dante.ru/redirect/",hit_url:"https://adviser.bs-dante.ru/candy/hit",hit_on:!0,migrated_url:"https://bs-dante.ru/api/v1/places/migrated",migrate_cookie:"dante_migrated_ids",storage_prefix:"dante_cookie_"},e),this.showObserver=new i,this.resizeObserver=new a,this.pageOptions={};var n=function(){if(t.pageOptions.length)return t.pageOptions;var e=document.querySelector('meta[name="candy.config"]'),n=document.querySelector('#fieldsetView [itemprop="price"]'),o={};try{o=e?JSON.parse(e.content):{};var r=n?n.innerHTML.replace(/\D/g,""):o.cf&&o.cf.p?o.cf.p:"";r&&(o.price=r)}catch(e){o={}}return o.geo_type||(o.geo_type=-1!==["baza.drom.ru","spec.drom.ru","moto.drom.ru","water.drom.ru"].indexOf(location.host)||-1!==location.host.indexOf("farpost.ru")?"baza":"ip2c"),o.geoc=o.geoc?o.geoc:0,o.geo_type=o.geo_type?o.geo_type:"",o.url=encodeURIComponent(window.location),t.pageOptions=o,o};this.resetPageOptions=function(){t.pageOptions={},n()};var o=[],s=null,c=function(e,i,a,c){o.push({banner_id:e,zone_id:i,place_id:a,opposing_ids:c});var l=function(){s=setTimeout((function(){var e,i;e=n(),i={shows:o,city_id:e.geoc,geo_type:e.geo_type,cookie:r.getLocalCookie(t.options.storage_prefix)},o=[],d(t.options.show_url,JSON.stringify(i),"post",(function(e){var n=JSON.parse(e.responseText);n&&n.data&&n.data.cookie&&r.setLocalCookie(t.options.storage_prefix,n.data.cookie)}),null,(function(){s=null,o.length&&l()}))}),1e3)};s||l()};return this.getMigratedPlaceIds=function(e){var n=r.getLocalStoredData(t.options.migrate_cookie);try{n=JSON.parse(n)}catch(e){n=null}var o=!1;n&&n.data&&n.data instanceof Array&&(e(n.data),o=!0),(!n||!n.data||!n.data instanceof Array||!n.expire||n.expire<(new Date).getTime())&&d(t.options.migrated_url,{},"get",(function(n){var i=JSON.parse(n.responseText).data;if(i instanceof Array){var a=new Date;a.setTime(a.getTime()+36e5);var s={data:i,expire:a.getTime()};r.setLocalStoredData(t.options.migrate_cookie,JSON.stringify(s)),o||e(i)}else console.error("dante: data migrated place ids wrong format",n.responseText),o||e([])}),(function(t){console.error("dante: error get migrated place ids",t),o||e([])}))},this.hit=function(){var e=n();d(t.options.hit_url,{loc:encodeURIComponent(window.location),ref:encodeURIComponent(document.referrer),extend:JSON.stringify(e),cookie:JSON.stringify(r.getLocalCookie(t.options.storage_prefix))},"get")},this.addPlaces=function(e,t){var n=document.querySelectorAll(e);for(var o in n)if(n.hasOwnProperty(o)){var r=n[o];if(!r.dataset||!r.dataset.id)return void console.error("dante: cant init place - place id attribute on selector "+e+" not found");this.addPlace(r,r.dataset.id,t)}},this.removePlaces=function(e){var t=document.querySelectorAll(e);for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];if(!o.dataset||!o.dataset.id)return void console.error("dante: cant remove place - place id attribute on selector "+e+" not found");this.removePlace(o.dataset.id)}},this.clear=function(){Object.keys(t.places).forEach((function(e){t.removePlace(e)})),t.showObserver.clear(),t.resizeObserver.clear(),t.resetPageOptions()},this.addPlace=function(e,n,o){e&&e instanceof HTMLElement?n?(o=r.merge({success_callback:function(){},empty_callback:function(){},fail_callback:function(){}},o),n=n.toString(),e.dataset.place=n,t.places[n]={element:e,id:n,options:o}):console.error("dante: cant init place - id is undefined",e):console.error("dante: cant init place - element not instance HTMLElement",e)},this.removePlace=function(e){(e=e.toString())&&t.places[e]?(t.places[e].element.innerHTML="",t.showObserver.remove(t.places[e].element),t.resizeObserver.remove(t.places[e].element),delete t.places[e]):console.error("dante: cant delete place - id or place is undefined",e)},this.update=function(e){var o=Object.keys(t.places);if(Array.isArray(e)&&(e=e.map((function(e){return e.toString()})),o=o.filter((function(t){return-1!==e.indexOf(t)}))),o.length){var i=n();d(t.options.banners_url,{places:o,options:i,cookie:r.getLocalCookie(t.options.storage_prefix)},"get",(function(e){var n=JSON.parse(e.responseText),a=n.data,s=n.extended&&n.extended.empty?n.extended.empty:{},d=n.extended&&n.extended.opposing?n.extended.opposing:{},u=n.extended&&n.extended.cookie?n.extended.cookie:"";u&&r.setLocalCookie(t.options.storage_prefix,u),o.forEach((function(e){var n=t.places[e];if(n){if(n.element.innerHTML="",!a[n.id])return r.elementSetHideStyle(n.element),s[n.id]&&t.showObserver.add(n.element,(function(){c(0,s[n.id],n.id,d[n.id])})),void("function"==typeof n.options.empty_callback&&n.options.empty_callback(n.element,n.id));r.elementSetShowStyle(n.element);var o=a[n.id];switch(o.type){case t.TYPE_HTML5:var u=document.createElement("iframe");u.name=o.id,u.src=o.source,u.scrolling="no",u.sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation-by-user-activation",u.seamless=!0,u.setAttribute("style","width:100%;height:"+(o.height?o.height+"px":"100%")+";box-sizing:border-box;border:none;position:relative;overflow:hidden;"),u.setAttribute("data-width",o.width),u.setAttribute("data-height",o.height),n.element.appendChild(u);var p="";try{(p=(p=n.element.dataset.customRedirectParams)?JSON.parse(p):{}).cookie=JSON.stringify(r.getLocalCookie(t.options.storage_prefix)),p="?"+l(p)}catch(e){p=""}var f=i.price?{price:i.price}:{};r.addEvent(u,"onload",(function(){var e={};e.curls=o.urls.map((function(e){return t.options.click_url+e+p})),e.data=f,this.contentWindow.postMessage(e,"*")}));break;case t.TYPE_JSON:return}o.border&&n.element.firstChild&&(n.element.firstChild.style.border="1px solid #000"),n.banner=o,t.showObserver.add(n.element,(function(){if(n.banner.zero_pixel){var e=document.createElement("img"),t=(+new Date).toString()+(Math.floor(888*Math.random())+111);e.src=n.banner.zero_pixel.replace("%dante_random%",t),e.setAttribute("style","width: 0!important;height: 0!important;"),n.element.appendChild(e)}c(n.banner.id,n.banner.from_zone_id,n.id,d[n.id])})),t.resizeObserver.add(n.element),"function"==typeof n.options.success_callback&&n.options.success_callback(n.element,n.id,n.banner)}}))}),(function(e){console.error("dante: bad request banner for places "+o.join(","),e),o.forEach((function(n){var o=t.places[n];o&&"function"==typeof o.options.fail_callback&&o.options.fail_callback(o.element,o.id,e)}))}))}else console.warn("dante: no banner places to update")},this.options.hit_on&&t.hit(),this}}}]);